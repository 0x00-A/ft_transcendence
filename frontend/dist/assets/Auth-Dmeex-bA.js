import{j as s,y as G,l as k,z,D as I,E as V,i as W,h as H,f as O,r as w,B as _,F as Q,G as J,H as K}from"./index-erQsObJq.js";import{u as R,o as q,L as X,a as $,S as Y}from"./formSchemas-CD-5kOut.js";import{F as T}from"./index-DRSugL2N.js";import{a as F,b as Z}from"./index-B703u2Bs.js";import{B as S,a as B}from"./index-zWRPu04G.js";import{O as ss}from"./OtpAuth-D4tcUVbL.js";import{G as as,I as es}from"./iconBase-Dy7Lu4j7.js";const ts="_authPongBox_iqukk_8",os="_switchPongBox_iqukk_26",ns="_logoHolder_iqukk_51",rs="_authFooter_iqukk_59",is="_pong_iqukk_86",cs="_play_iqukk_1",us="_moveOne_iqukk_1",ls="_moveTwo_iqukk_1",N={authPongBox:ts,switchPongBox:os,logoHolder:ns,authFooter:rs,pong:is,play:cs,moveOne:us,moveTwo:ls},ds=({isLogin:o})=>s.jsxs("div",{className:`${N.authPongBox} ${o?"":N.switchPongBox}`,children:[s.jsx("div",{className:N.logoHolder,children:s.jsx("img",{src:G,alt:""})}),s.jsxs("div",{className:N.pong,children:[s.jsx("div",{}),s.jsx("div",{}),s.jsx("div",{})]})]}),ms=()=>{const{register:o,handleSubmit:i,formState:{errors:r},setError:e,reset:c,watch:d}=R({resolver:q(X()),reValidateMode:"onChange",mode:"onChange"}),j=$({mutationFn:async u=>await k.post(z,u),onError(u){var l;if(I.isAxiosError(u)){const n=(l=u==null?void 0:u.response)==null?void 0:l.data;n!=null&&n.username&&e("username",{type:"manual",message:n.username},{shouldFocus:!0}),n!=null&&n.password&&e("password",{type:"manual",message:n.password},{shouldFocus:!0}),n!=null&&n.error&&e("root",{type:"manual",message:n==null?void 0:n.error})}else e("root",{type:"manual",message:"Something went wrong!"})}});return{register:o,handleSubmit:i,errors:r,setError:e,reset:c,mutation:j,watch:d}},hs="_loginContainer_1yjg2_1",ps="_entryArea_1yjg2_10",gs="_authFormHeader_1yjg2_21",_s="_authTitle_1yjg2_31",xs="_inputContainer_1yjg2_38",js="_inputIcon_1yjg2_57",fs="_fieldError_1yjg2_67",ws="_showPassIcon_1yjg2_119",ys="_authBtn_1yjg2_127",vs="_forgotPass_1yjg2_148",a={loginContainer:hs,entryArea:ps,authFormHeader:gs,authTitle:_s,inputContainer:xs,inputIcon:js,fieldError:fs,showPassIcon:ws,authBtn:ys,forgotPass:vs},Ns="_oauth2Container_1pyb9_1",Cs="_or_1pyb9_9",Fs="_oauth2Buttons_1pyb9_26",Ss="_oauthBtn_1pyb9_33",Bs="_oauth2Icon_1pyb9_44",x={oauth2Container:Ns,or:Cs,oauth2Buttons:Fs,oauthBtn:Ss,oauth2Icon:Bs};function ks(o){return as({tag:"svg",attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`},child:[]},{tag:"path",attr:{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`},child:[]},{tag:"path",attr:{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`},child:[]},{tag:"path",attr:{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`},child:[]}]})(o)}const M=()=>{const o=i=>{const r=`${V}/${i}/`;window.location.href=r};return s.jsxs("div",{className:x.oauth2Container,children:[s.jsxs("div",{className:x.or,children:[s.jsx("div",{}),s.jsx("p",{children:"OR"}),s.jsx("div",{})]}),s.jsxs("div",{className:x.oauth2Buttons,children:[s.jsx("button",{className:x.oauthBtn,type:"submit",onClick:()=>o("intra"),children:s.jsx("img",{src:"/assets/42Logo.svg",alt:"?",className:x.oauth2Icon})}),s.jsx("button",{className:x.oauthBtn,type:"submit",onClick:()=>o("google"),children:s.jsx(es.Provider,{value:{size:"2em"},children:s.jsx(ks,{className:x.oauth2Icon})})}),s.jsx("button",{className:x.oauthBtn,type:"submit",onClick:()=>o("discord"),children:s.jsx("img",{src:"/assets/discordIcon.svg",alt:"?",className:x.oauth2Icon})})]})]})},Is=()=>{var E;const{register:o,handleSubmit:i,errors:r,mutation:e,reset:c,watch:d}=ms(),j=W(),{setIsLoggedIn:u}=H(),l=O(),[n,t]=w.useState(!1),[m,p]=w.useState(!1),v=d("username");w.useEffect(()=>{var g,h,f,y,P,b,A,L;if(e.isSuccess){if((h=(g=e.data)==null?void 0:g.data)!=null&&h.status&&((f=e.data)==null?void 0:f.data.status)==="2FA_REQUIRED"){c(),p(!0),(P=(y=e.data)==null?void 0:y.data)!=null&&P.message?_.info((b=e.data)==null?void 0:b.data.message):_.info("2FA required, please enter otp");return}_.success((L=(A=e.data)==null?void 0:A.data)==null?void 0:L.message),c(),u(!0),j("/")}},[e.isSuccess]),w.useEffect(()=>{var g,h;return r.root&&_.error(((h=(g=r.root)==null?void 0:g.message)==null?void 0:h.at(0))??"something went wrong!"),()=>{var f;(f=l.current)==null||f.complete()}},[e.isError]);const U=g=>{var h;(h=l.current)==null||h.continuousStart(),e.mutate(g)},D=async()=>{var g,h,f;if(!v){_.error("Please enter your username!");return}if(v&&!r.username){try{const y=await k.post(Q,{username:v});_.success((g=y.data)==null?void 0:g.message)}catch(y){I.isAxiosError(y)?_.error((f=(h=y.response)==null?void 0:h.data)==null?void 0:f.error):_.error("Something went wrong!")}c()}};return s.jsx("div",{className:a.loginContainer,children:m?s.jsx(ss,{setOtpRequired:p,username:(E=e.data)==null?void 0:E.data.username,loadingBarRef:l}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:a.authFormHeader,children:s.jsx("h1",{children:"Welcome back"})}),s.jsxs("form",{className:a.entryArea,onSubmit:i(U),children:[s.jsxs("div",{className:a.inputContainer,children:[s.jsx(T,{className:a.inputIcon}),s.jsx("input",{type:"text",required:!0,placeholder:"username",...o("username")}),r.username&&s.jsx("span",{className:a.fieldError,children:r.username.message})]}),s.jsxs("div",{className:a.inputContainer,children:[s.jsx(F,{className:a.inputIcon}),s.jsx("input",{type:n?"text":"password",required:!0,placeholder:"password",...o("password")}),n?s.jsx(S,{className:a.showPassIcon,onClick:()=>t(!n)}):s.jsx(B,{className:a.showPassIcon,onClick:()=>t(!n)}),r.password&&s.jsx("span",{className:a.fieldError,children:r.password.message})]}),s.jsx("div",{className:a.forgotPass,onClick:D,children:"Forgot your password?"}),s.jsx("button",{type:"submit",className:a.authBtn,children:"Sign in"})]}),s.jsx(M,{})]})})},Es=()=>{const{register:o,handleSubmit:i,formState:{errors:r},reset:e,watch:c,setError:d,clearErrors:j}=R({resolver:q(Y()),reValidateMode:"onChange",mode:"onChange"}),u=$({mutationFn:async l=>await k.post(J,l),onError:l=>{var n;if(I.isAxiosError(l)){const t=(n=l==null?void 0:l.response)==null?void 0:n.data;t!=null&&t.username&&d("username",{type:"manual",message:t.username},{shouldFocus:!0}),t!=null&&t.email&&d("email",{type:"manual",message:t.email},{shouldFocus:!0}),t!=null&&t.password&&(Array.isArray(t.password)?d("password",{type:"manual",message:t.password.join("-")},{shouldFocus:!0}):d("password",{type:"manual",message:t.password},{shouldFocus:!0})),t!=null&&t.error&&d("root",{type:"manual",message:t.error})}else d("root",{type:"manual",message:"Something went wrong!"})}});return{register:o,handleSubmit:i,errors:r,mutation:u,reset:e,watch:c,setError:d,clearErrors:j}},Ps=({setIslogin:o})=>{const{register:i,handleSubmit:r,errors:e,mutation:c,reset:d}=Es(),j=O(),[u,l]=w.useState({password:!1,confirm_pass:!1});w.useEffect(()=>{var m,p;c.isSuccess&&(_.success((p=(m=c==null?void 0:c.data)==null?void 0:m.data)==null?void 0:p.message),d(),o(!0))},[c.isSuccess,o]),w.useEffect(()=>(e.root&&_.error(e.root.message),()=>{var m;(m=j.current)==null||m.complete()}),[c.isError]);const n=(m,p)=>{var v;p.preventDefault(),(v=j.current)==null||v.continuousStart(),c.mutate(m)},t=m=>{l(p=>({...p,[m]:!p[m]}))};return s.jsxs("div",{className:a.loginContainer,children:[s.jsx("h1",{className:a.authTitle,children:"Welcome"}),s.jsx("p",{children:"Join us and enjoy the game"}),s.jsxs("form",{noValidate:!0,className:a.entryArea,onSubmit:r(n),children:[s.jsxs("div",{className:a.inputContainer,children:[s.jsx(T,{className:a.inputIcon}),s.jsx("input",{type:"text",placeholder:"username",...i("username")}),e.username&&s.jsx("span",{className:a.fieldError,children:e.username.message})]}),s.jsxs("div",{className:a.inputContainer,children:[s.jsx(Z,{className:a.inputIcon}),s.jsx("input",{type:"email",placeholder:"email",...i("email")}),e.email&&s.jsx("span",{className:a.fieldError,children:e.email.message})]}),s.jsxs("div",{className:a.inputContainer,children:[s.jsx(F,{className:a.inputIcon}),s.jsx("input",{type:u.password?"text":"password",required:!0,placeholder:"password",...i("password")}),u.password?s.jsx(S,{className:a.showPassIcon,onClick:()=>t("password")}):s.jsx(B,{className:a.showPassIcon,onClick:()=>t("password")}),e.password&&s.jsx("span",{className:a.fieldError,children:e.password.message})]}),s.jsxs("div",{className:a.inputContainer,children:[s.jsx(F,{className:a.inputIcon}),s.jsx("input",{type:u.confirm_pass?"text":"password",required:!0,placeholder:"password confirmation",...i("password2")}),u.confirm_pass?s.jsx(S,{className:a.showPassIcon,onClick:()=>t("confirm_pass")}):s.jsx(B,{className:a.showPassIcon,onClick:()=>t("confirm_pass")}),e.password2&&s.jsx("span",{className:a.fieldError,children:e.password2.message})]}),s.jsx("button",{type:"submit",className:a.authBtn,children:"Sign up"})]}),s.jsx(M,{})]})},bs="_authContainer_7kfv8_1",As="_authFormBox_7kfv8_11",Ls="_authFormSwitch_7kfv8_26",Hs="_authFormHeader_7kfv8_55",Os="_authBtn_7kfv8_103",Rs="_authError_7kfv8_123",qs="_disapear_7kfv8_1",$s="_authSuccess_7kfv8_143",Ts="_authFooter_7kfv8_177",C={authContainer:bs,authFormBox:As,authFormSwitch:Ls,authFormHeader:Hs,authBtn:Os,authError:Rs,disapear:qs,authSuccess:$s,authFooter:Ts},Qs=()=>{const[o,i]=w.useState(!0),{isLoggedIn:r,isLoading:e}=H();if(!e)return r?s.jsx(K,{to:"/"}):s.jsxs("div",{className:C.authContainer,children:[s.jsxs("div",{className:`${C.authFormBox} ${o?"":C.authFormSwitch}`,children:[o?s.jsx(Is,{}):s.jsx(Ps,{setIslogin:i}),s.jsxs("div",{className:C.authFooter,children:[s.jsx("p",{children:o?"Don't have an account?":"Already have an account?"}),s.jsx("button",{onClick:()=>{i(!o)},children:o?"Signup":"Login"})]})]}),s.jsx(ds,{isLogin:o})]})};export{Qs as default};
