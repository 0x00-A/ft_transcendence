import{c as C,r as b,u as L,i as F,k as E,j as e,a8 as R,B as x,t as U,s as $,v as V,q as I,ak as q,al as A,am as O,an as T,D as G,ao as M,ap as z}from"./index-erQsObJq.js";import{c as a,a as i,b as y,P as D,d as K}from"./ProfileAchievements-DPnAQLb7.js";import{S as Q}from"./swords-BhQSw9JP.js";import{U as H}from"./users-CJsmYFnL.js";import{U as W}from"./user-x-CI-A9uXX.js";import{U as X}from"./user-plus-CBelkoYu.js";import{F as B}from"./FriendSkeleton-C6d5tkeq.js";import"./iconBase-Dy7Lu4j7.js";import"./helpers-BRqGwH6J.js";import"./award-DuErkQHu.js";/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=C("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=C("MessageSquareMore",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M16 10h.01",key:"1m94wz"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=C("ShieldMinus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=C("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),se="_moreMenu_9r4te_1",ae="_menu_9r4te_6",re="_menuItem_9r4te_18",ne="_disabled_9r4te_32",le="_cooldownTimer_9r4te_37",h={moreMenu:se,menu:ae,menuItem:re,disabled:ne,cooldownTimer:le},te=({userData:g})=>{const[s,r]=b.useState(!1),{t:l}=L(),n=F(),{user:c,refetch:o}=g,[p,j]=b.useState(!1),[f,m]=b.useState(0),{sendMessage:v}=E(),t=b.useRef(null),N=b.useRef(null),P=()=>{r(u=>!u)},S=u=>{n("/chat",{state:{selectedFriend:u}}),r(!1)},w=async u=>{try{await R(u),r(!1),o()}catch(k){x.error(k.message||l("errorsFriends.block"))}},_=u=>{p||(v({event:"game_invite",from:c==null?void 0:c.username,to:u}),r(!1),j(!0),m(10))};return b.useEffect(()=>{let u;return p&&f>0&&(u=setInterval(()=>{m(k=>k-1)},1e3)),f===0&&p&&j(!1),()=>clearInterval(u)},[p,f]),b.useEffect(()=>{const u=k=>{const d=k.target;t.current&&!t.current.contains(d)&&N.current&&!N.current.contains(d)&&r(!1)};return s&&document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[s]),e.jsxs("div",{className:h.moreMenu,children:[e.jsx("div",{ref:N,onClick:P,className:h.moreButton,children:e.jsx(J,{color:"#f8c35c"})}),s&&e.jsxs("div",{ref:t,className:h.menu,children:[e.jsxs("div",{className:h.menuItem,onClick:()=>S(c.username),children:[e.jsx(Y,{color:"#f8c35c",className:h.menuIcon}),e.jsx("span",{children:l("Profile.profileHeader.buttons.messageBtn")})]}),e.jsxs("div",{className:h.menuItem,onClick:()=>w(c.username),children:[e.jsx(Z,{color:"#f8c35c",className:h.menuIcon}),e.jsx("span",{children:l("Profile.profileHeader.buttons.blockBtn")})]}),e.jsxs("div",{className:`${h.menuItem} ${p?h.disabled:""}`,onClick:()=>_(c.username),children:[e.jsx(Q,{color:"#f8c35c",className:`${h.menuIcon}`}),p?e.jsxs("span",{className:h.cooldownTimer,children:[f,"s"]}):e.jsx("span",{children:l("Profile.profileHeader.buttons.challengeBtn")})]})]})]})},ie=({getUserData:g})=>{var f,m,v,t,N,P,S,w,_,u,k;const{user:s,isLoading:r,refetch:l}=g,{t:n}=L(),c=d=>{switch(d){case"Bronze":return n("Profile.profileHeader.badge.Bronze");case"Silver":return n("Profile.profileHeader.badge.Silver");case"Gold":return n("Profile.profileHeader.badge.Gold");case"Platinum":return n("Profile.profileHeader.badge.Platinum");case"Diamond":return n("Profile.profileHeader.badge.Diamond");case"Ft-Pong":return n("Profile.profileHeader.badge.Ft-Pong");default:return d}},o=async()=>{try{const d=await U(s.username);x.success(d),l()}catch(d){x.error(d.message)}},p=async()=>{try{const d=await $(s.username);x.success(d),l()}catch(d){x.error(d.message)}},j=async()=>{try{const d=await V(s.username);x.success(d),l()}catch(d){x.error(d.message)}};return e.jsxs("div",{className:a.profileHeaderContainer,children:[e.jsx("div",{className:a.profileBackground,children:r?e.jsx("div",{className:"h-10 w-44 bg-gray-700 animate-pulse flex-center"}):e.jsxs("div",{className:a.friendState,children:[(s==null?void 0:s.friend_status)==="Friends"&&e.jsxs("div",{className:a.friendStatBtn,children:[e.jsx("div",{className:a.btnLabel,children:n("Profile.profileHeader.buttons.friendsBtn")}),e.jsx(H,{color:"#f8c35c"})]}),(s==null?void 0:s.friend_status)==="Cancel"&&e.jsxs("div",{className:a.friendStatBtn,onClick:o,children:[e.jsx("div",{className:a.btnLabel,children:n("Profile.profileHeader.buttons.cancelBtn")}),e.jsx(W,{color:"#f8c35c"})]}),(s==null?void 0:s.friend_status)==="Accept"&&e.jsxs("div",{className:a.friendStatBtn,onClick:j,children:[e.jsx("div",{className:a.btnLabel,children:n("Profile.profileHeader.buttons.acceptBtn")}),e.jsx(ee,{color:"#f8c35c"})]}),(s==null?void 0:s.friend_status)==="Add"&&e.jsxs("div",{className:a.friendStatBtn,onClick:p,children:[e.jsx("div",{className:a.btnLabel,children:n("Profile.profileHeader.buttons.addBtn")}),e.jsx(X,{color:"#f8c35c"})]}),e.jsxs("div",{className:a.moreBtn,children:[e.jsx("div",{className:a.btnLabelMore,children:n("Profile.profileHeader.buttons.moreBtn")}),e.jsx(te,{userData:{user:s,refetch:l}})]})]})}),r?e.jsxs("div",{className:"w-[150px] h-[200px] absolute left-1/2 top-[45%] transform -translate-x-1/2 text-center rounded-lg animate-pulse flex flex-col items-center",children:[e.jsx("div",{className:"w-[150px] h-[150px] relative",children:e.jsx("div",{className:"w-full h-full rounded-[25px] bg-gray-700"})}),e.jsx("div",{className:"w-[100px] h-[20px] bg-gray-700 rounded-md mt-4"})]}):e.jsxs("div",{className:a.profileCard,children:[e.jsxs("div",{className:a.avatarContainer,children:[e.jsx("img",{src:(f=s==null?void 0:s.profile)==null?void 0:f.avatar,alt:"",className:a.profileAvatar}),e.jsx("span",{className:a.profileLevel,children:((m=s==null?void 0:s.profile)==null?void 0:m.level)||0})]}),e.jsx("h2",{children:s==null?void 0:s.username})]}),e.jsxs("div",{className:a.profileStats,children:[e.jsxs("div",{className:a.leftStats,children:[e.jsxs("div",{className:a.totalGames,children:[r?e.jsx("span",{className:"statValueSkeleton block w-[40px] h-[40px] bg-gray-500 rounded-md animate-pulse"}):e.jsx("span",{className:a.statValue,children:((v=s==null?void 0:s.profile)==null?void 0:v.played_games)||0}),e.jsx("span",{className:a.statLabel,children:n("Profile.profileHeader.profileStats.games")})]}),e.jsxs("div",{className:a.wins,children:[r?e.jsx("span",{className:"statValueSkeleton block w-[40px] h-[40px] bg-gray-500 rounded-md animate-pulse"}):e.jsx("span",{className:a.statValue,children:((t=s==null?void 0:s.profile)==null?void 0:t.wins)||0}),e.jsx("span",{className:a.statLabel,children:n("Profile.profileHeader.profileStats.wins")})]}),e.jsxs("div",{className:a.loses,children:[r?e.jsx("span",{className:"statValueSkeleton block w-[40px] h-[40px] bg-gray-500 rounded-md animate-pulse"}):e.jsx("span",{className:a.statValue,children:((N=s==null?void 0:s.profile)==null?void 0:N.loses)||0}),e.jsx("span",{className:a.statLabel,children:n("Profile.profileHeader.profileStats.loses")})]})]}),e.jsxs("div",{className:a.leftStats,children:[e.jsxs("div",{className:a.badge,children:[r?e.jsx("span",{className:"statValueSkeleton block w-[40px] h-[40px] bg-gray-500 rounded-md animate-pulse"}):e.jsx("img",{src:(S=(P=s==null?void 0:s.profile)==null?void 0:P.badge)==null?void 0:S.icon,alt:"",className:a.badgeIcon}),r?e.jsx("span",{className:"statValueSkeleton block w-[40px] h-[10px] bg-gray-500 rounded-md animate-pulse"}):e.jsx("span",{className:a.statLabel,children:c(((_=(w=s==null?void 0:s.profile)==null?void 0:w.badge)==null?void 0:_.name)||"")})]}),e.jsxs("div",{className:a.score,children:[r?e.jsx("span",{className:"statValueSkeleton block w-[40px] h-[40px] bg-gray-500 rounded-md animate-pulse"}):e.jsx("span",{className:a.statValue,children:((u=s==null?void 0:s.profile)==null?void 0:u.score)||0}),e.jsx("span",{className:a.statLabel,children:n("Profile.profileHeader.profileStats.score")})]}),e.jsxs("div",{className:a.rank,children:[r?e.jsx("span",{className:"statValueSkeleton block w-[40px] h-[40px] bg-gray-500 rounded-md animate-pulse"}):e.jsx("span",{className:a.statValue,children:((k=s==null?void 0:s.profile)==null?void 0:k.rank)||"?"}),e.jsx("span",{className:a.statLabel,children:n("Profile.profileHeader.profileStats.rank")})]})]})]})]})},ce=({username:g})=>{var v;const[s,r]=b.useState(!0),{data:l,isLoading:n,error:c}=I(`${q}/${g}`),{data:o,isLoading:p,error:j}=I(`${A}/${g}`),f=F(),{t:m}=L();return e.jsxs("div",{className:i.profileFriendsContainer,children:[e.jsx("div",{className:i.friendsHeader,children:e.jsxs("div",{className:i.friendsTitle,children:[e.jsx(H,{size:30,color:"#f8c25c"}),e.jsx("h3",{children:m("Profile.FriendsOther.title")})]})}),e.jsxs("div",{className:i.friendsList,children:[e.jsxs("div",{className:i.buttonsGrp,children:[e.jsxs("button",{onClick:()=>r(!0),className:`${i.button} ${s?i.buttonActive:""}`,children:[m("Profile.FriendsOther.mutualFriends")," ",o==null?void 0:o.mutual_friends_count]}),e.jsx("button",{onClick:()=>r(!1),className:`${i.button} ${s?"":i.buttonActive}`,children:m("Profile.FriendsOther.allFriends")})]}),s?p?e.jsx(B,{}):e.jsxs("div",{className:i.friendList,children:[j&&e.jsx("p",{children:j.message}),o&&o.mutual_friends_count==0&&e.jsx("span",{className:i.noCurrentFriend,children:m("Profile.FriendsOther.noMutualFriends")}),o&&o.mutual_friends_count>0&&((v=o.mutual_friends)==null?void 0:v.map(t=>e.jsxs("div",{className:i.friendItem,children:[e.jsx("img",{src:t.profile.avatar,alt:t.username,className:i.avatar}),e.jsxs("div",{className:i.friendInfo,children:[e.jsx("span",{className:i.name,onClick:()=>f(`/profile/${t.username}`),children:t.username}),e.jsxs("span",{className:i.level,children:[m("Profile.FriendsOther.Level")," ",t.profile.level]})]})]},t.id)))]}):n?e.jsx(B,{}):e.jsxs("div",{className:i.friendList,children:[c&&e.jsx("p",{children:c.message}),l&&(l==null?void 0:l.length)==0&&e.jsx("span",{className:i.noCurrentFriend,children:m("Profile.FriendsOther.playerLonely")}),l&&(l==null?void 0:l.length)>0&&(l==null?void 0:l.map(t=>e.jsxs("div",{className:i.friendItem,children:[e.jsx("img",{src:t.profile.avatar,alt:t.username,className:i.avatar}),e.jsxs("div",{className:i.friendInfo,children:[e.jsx("span",{className:i.name,onClick:()=>f(`/profile/${t.username}`),children:t.username}),e.jsxs("span",{className:i.level,children:[m("Profile.FriendsOther.Level")," ",t.profile.level]})]})]},t.id)))]})]})]})},ge=()=>{const{username:g}=O(),{data:s,isLoading:r,refetch:l,isError:n,error:c}=T({queryKey:[M,g],queryFn:()=>z(`${M}${g}`),retry:0}),o=F();return b.useEffect(()=>{var p,j,f,m,v,t,N;n&&(G.isAxiosError(c)?c.status===404?(x.error((p=c.response)==null?void 0:p.data.error),o("/profile")):((j=c.response)==null?void 0:j.data.status)==="me"?o("/profile"):((f=c.response)==null?void 0:f.data.status)==="Blocker"?(x.error(((m=c.response)==null?void 0:m.data.message)||"Can't view this profile"),o("/friends?view=blocked")):((v=c.response)==null?void 0:v.data.status)==="Blocked"?(x.error(((t=c.response)==null?void 0:t.data.message)||"Can't view this profile"),o(-1)):(x.error(((N=c.response)==null?void 0:N.data.message)||"Something went wrong, try again!"),o("/")):(x.error("Something went wrong, try again!"),o("/")))},[n,c,o]),r?e.jsx("div",{className:y.profileContainer}):n?null:s?e.jsxs("div",{className:y.profileContainer,children:[e.jsx(ie,{getUserData:{user:s,isLoading:r,refetch:l}}),e.jsxs("div",{className:y.profileBodyConatiner,children:[r?e.jsx("div",{className:"w-[40%] h-[100%] bg-gray-700 animate-pulse rounded-lg"}):e.jsx(ce,{username:s==null?void 0:s.username}),e.jsxs("div",{className:y.rightBodyContainer,children:[r?e.jsx("div",{className:"w-[100%] h-[40%] bg-gray-700 animate-pulse rounded-lg"}):e.jsx(D,{username:s==null?void 0:s.username}),r?e.jsx("div",{className:"w-[100%] h-[60%] bg-gray-700 animate-pulse rounded-lg"}):e.jsx(K,{isOtherUser:!0,username:s==null?void 0:s.username})]})]})]}):e.jsx("div",{className:y.profileContainer,children:e.jsx("h1",{children:"404 Not Found"})})};export{ge as default};
